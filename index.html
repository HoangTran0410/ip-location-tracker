<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IP Location Tracker - 3D Globe</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">‚ò∞</button>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" onclick="toggleMobileMenu()"></div>

    <div class="container">
      <div class="sidebar" id="sidebar">
        <h1>üåç IP Location Tracker</h1>
        <p class="description">Enter list IPs to see where it is.</p>
        <a
          href="https://github.com/HoangTran0410/ip-location-tracker"
          target="_blank"
          class="github-link"
          style="margin-bottom: 10px"
          >Open source üë®‚Äçüíª</a
        >

        <div class="stats">
          <div class="stat-card">
            <div class="stat-value" id="totalIPs">0</div>
            <div class="stat-label">Total IPs</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="foundIPs">0</div>
            <div class="stat-label">Located</div>
          </div>
          <div
            class="stat-card"
            style="grid-column: span 2; cursor: pointer"
            onclick="clearCache()"
            title="Click to clear cache"
          >
            <div class="stat-value" id="cachedIPs">0</div>
            <div class="stat-label">Cached IPs üóëÔ∏è</div>
          </div>
        </div>

        <div class="input-group">
          <label for="apiProvider">API Provider:</label>
          <select
            id="apiProvider"
            class="filter-select"
            style="width: 100%; margin-bottom: 15px"
          >
            <option value="auto">Auto (with fallback)</option>
            <option value="ipwho">ipwho.is (HTTPS, no rate limit)</option>
            <option value="ipapi">ip-api.com (HTTP, 45/min)</option>
            <option value="ipapico">ipapi.co (HTTPS, 1000/day)</option>
            <option value="ipinfo">ipinfo.io (HTTPS, 50k/month)</option>
            <option value="ipquery">ipquery.io (HTTPS, free tier)</option>
          </select>
          <label
            style="
              display: flex;
              align-items: center;
              cursor: pointer;
              user-select: none;
            "
          >
            <input
              type="checkbox"
              id="bypassCache"
              style="
                margin-right: 8px;
                width: 18px;
                height: 18px;
                cursor: pointer;
              "
            />
            <span>Bypass cache (force API fetch)</span>
          </label>
        </div>

        <div class="input-group">
          <label for="ipList">IP List:</label>
          <textarea
            id="ipList"
            placeholder="8.8.8.8&#10;1.1.1.1&#10;208.67.222.222&#10;142.250.185.46"
          ></textarea>
        </div>

        <button id="locateBtn" onclick="locateIPs()">
          üîç Locate IPs on Globe
        </button>
        <button class="danger" onclick="clearResults()">üóëÔ∏è Clear All</button>

        <div id="errorContainer"></div>

        <!-- Search and Filters -->
        <div
          class="search-filter-section"
          id="searchFilterSection"
          style="display: none"
        >
          <input
            type="text"
            class="search-box"
            id="searchBox"
            placeholder="üîç Search by IP, city, country, ISP..."
            oninput="applyFilters()"
          />

          <div class="filters-container">
            <select
              class="filter-select"
              id="filterCountry"
              onchange="applyFilters()"
            >
              <option value="">All Countries</option>
            </select>

            <select
              class="filter-select"
              id="filterCity"
              onchange="applyFilters()"
            >
              <option value="">All Cities</option>
            </select>

            <select
              class="filter-select"
              id="filterRegion"
              onchange="applyFilters()"
            >
              <option value="">All Regions</option>
            </select>

            <select
              class="filter-select"
              id="filterISP"
              onchange="applyFilters()"
            >
              <option value="">All ISPs</option>
            </select>

            <select
              class="filter-select"
              id="filterMobile"
              onchange="applyFilters()"
            >
              <option value="">All Connection Types</option>
              <option value="mobile">Mobile/Cellular</option>
              <option value="broadband">Broadband/WiFi</option>
            </select>

            <select
              class="filter-select"
              id="filterTimezone"
              onchange="applyFilters()"
            >
              <option value="">All Timezones</option>
            </select>
          </div>

          <div class="filter-actions">
            <button class="filter-btn" onclick="clearFilters()">
              Clear Filters
            </button>
          </div>

          <div class="results-header">
            <span id="filteredCount">0</span> /
            <span id="totalCount">0</span> results
          </div>
        </div>

        <div class="results" id="results"></div>
      </div>

      <div class="main-content">
        <div id="loading" class="loading hidden">
          <div class="spinner"></div>
          <div>Loading globe...</div>
        </div>

        <div class="controls">
          <button
            class="control-btn"
            onclick="resetCamera()"
            title="Reset View"
          >
            üè†
          </button>
          <button
            class="control-btn"
            onclick="toggleRotation()"
            title="Toggle Rotation"
          >
            ‚èØÔ∏è
          </button>
          <button
            class="control-btn"
            onclick="toggleBorders()"
            title="Toggle Country Borders"
            id="bordersBtn"
          >
            üó∫Ô∏è
          </button>
        </div>

        <div class="legend">
          <div style="font-weight: 600; margin-bottom: 10px; font-size: 1em">
            Legend
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #ff1744"></div>
            <span>Single IP</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #ffa726"></div>
            <span>Clustered IPs</span>
          </div>
          <div class="legend-item">
            <div
              class="legend-color"
              style="background: rgba(0, 100, 200, 0.5); border: 1px solid #fff"
            ></div>
            <span>Country Borders</span>
          </div>
        </div>

        <div id="globe"></div>
      </div>
    </div>

    <script src="//unpkg.com/globe.gl"></script>
    <script src="main.js"></script>
  </body>
</html>
